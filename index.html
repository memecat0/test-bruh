<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Internet Speed Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f4f4f9;
        }
        #speed-display {
            font-size: 2em;
            margin: 20px;
            color: #333;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #start-button {
            background-color: #4caf50;
            color: white;
        }
        #retry-button {
            background-color: #f44336;
            color: white;
            display: none;
        }
        #loading {
            display: none;
            font-size: 1.2em;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>Internet Speed Test</h1>
    <div id="speed-display">Your internet speed is: 0 Mbps</div>
    <div id="loading">Testing...</div>
    <button id="start-button">Started!</button>
    <button id="retry-button">Try Again?</button>

    <script>
        const speedDisplay = document.getElementById("speed-display");
        const startButton = document.getElementById("start-button");
        const retryButton = document.getElementById("retry-button");
        const loadingText = document.getElementById("loading");

        async function testInternetSpeed() {
            const testUrl = "https://speed.hetzner.de/100MB.bin"; // File to measure speed
            const fileSizeInBytes = 100 * 1024 * 1024; // File size (100 MB in bytes)
            
            try {
                loadingText.style.display = "block";
                speedDisplay.textContent = "Your internet speed is: 0 Mbps";

                const startTime = performance.now(); // Start timer
                const response = await fetch(testUrl, { method: "GET", cache: "no-cache" });
                await response.blob(); // Download file
                const endTime = performance.now(); // End timer

                const durationInSeconds = (endTime - startTime) / 1000;
                const speedInMbps = (fileSizeInBytes * 8) / (durationInSeconds * 1024 * 1024); // Mbps calculation
                
                loadingText.style.display = "none";
                speedDisplay.textContent = `Your internet speed is: ${speedInMbps.toFixed(2)} Mbps`;
                retryButton.style.display = "inline-block";
            } catch (error) {
                loadingText.style.display = "none";
                speedDisplay.textContent = "Error measuring speed. Try again!";
                retryButton.style.display = "inline-block";
                console.error("Error testing speed:", error);
            }
        }

        startButton.addEventListener("click", () => {
            startButton.style.display = "none";
            retryButton.style.display = "none";
            testInternetSpeed();
        });

        retryButton.addEventListener("click", () => {
            retryButton.style.display = "none";
            testInternetSpeed();
        });
    </script>
</body>
</html>
